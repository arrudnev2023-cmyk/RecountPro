<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>База штрих‑кодов</title>
<style>
    body { font-family: Arial; margin: 20px; }
    input, textarea { width: 100%; padding: 8px; margin: 5px 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { border: 1px solid #ccc; padding: 8px; }
    th { background: #eee; }
    .found { font-size: 20px; margin-top: 10px; font-weight: bold; }
</style>
</head>
<body>

<h2>Добавить штрих‑код вручную</h2>
<input id="code" placeholder="Штрих‑код">
<input id="name" placeholder="Название товара">
<button onclick="addItem()">Добавить</button>

<h2>Массовый импорт</h2>
<textarea id="bulk" rows="6" placeholder='"4600605026533": "Молоко простоквашино"
"4810268035258": "Сыр российский"
"4630111539289": "Снегокат Тимка спорт 6"'></textarea>
<button onclick="bulkImport()">Импортировать</button>

<h2>Сканирование / поиск</h2>
<input id="scan" placeholder="Сканируйте штрих‑код" oninput="scanCode()">
<div id="result" class="found"></div>

<h2>База товаров</h2>
<table id="table">
    <thead>
        <tr><th>Штрих‑код</th><th>Название</th></tr>
    </thead>
    <tbody></tbody>
</table>

<script>
let db = JSON.parse(localStorage.getItem("barcodeDB") || "{}");

function saveDB() {
    localStorage.setItem("barcodeDB", JSON.stringify(db));
    renderTable();
}

function addItem() {
    const code = document.getElementById("code").value.trim();
    const name = document.getElementById("name").value.trim();
    if (!code || !name) return alert("Введите код и название");
    db[code] = name;
    saveDB();
}

function bulkImport() {
    const text = document.getElementById("bulk").value.trim();
    const lines = text.split("\n");
    lines.forEach(line => {
        const match = line.match(/"(\d+)":\s*"(.+?)"/);
        if (match) {
            db[match[1]] = match[2];
        }
    });
    saveDB();
}

function scanCode() {
    const code = document.getElementById("scan").value.trim();
    document.getElementById("result").innerText =
        db[code] ? db[code] : "Товар не найден";
}

function renderTable() {
    const tbody = document.querySelector("#table tbody");
    tbody.innerHTML = "";
    Object.keys(db).forEach(code => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${code}</td><td>${db[code]}</td>`;
        tbody.appendChild(tr);
    });
}

renderTable();
</script>

</body>
</html>
