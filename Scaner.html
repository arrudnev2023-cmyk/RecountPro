<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LendX — люди людям</title>
  <style>
    :root{
      --bg:#0b0e13;
      --glass:rgba(255,255,255,0.08);
      --glass-strong:rgba(255,255,255,0.14);
      --text:#e7e9ee;
      --muted:#a9afbf;
      --accent:#7aa9ff;
      --good:#4ade80;
      --bad:#fb7185;
      --warn:#fbbf24;
      --card-radius:18px;
      --shadow:0 10px 30px rgba(0,0,0,0.35);
      --blur:20px;
    }
    *{box-sizing:border-box}
    html,body{background:radial-gradient(1200px 800px at 70% 10%,#12203a 0%,#0b0e13 55%,#06070a 100%); color:var(--text); margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif}
    .grid{display:grid; grid-template-columns:1fr minmax(280px,1100px) 1fr}
    header{grid-column:1/-1; padding:28px 24px; position:sticky; top:0; backdrop-filter:saturate(140%) blur(12px); background:linear-gradient(180deg,rgba(11,14,19,0.7),rgba(11,14,19,0)); z-index:10; border-bottom:1px solid rgba(255,255,255,0.06)}
    .wrap{grid-column:2}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:40px; height:40px; border-radius:12px; background:conic-gradient(from 180deg at 50% 50%, #7aa9ff, #8b5cf6, #22d3ee, #7aa9ff); box-shadow:0 10px 30px rgba(122,169,255,0.25)}
    .title{font-weight:700; letter-spacing:0.2px}
    .subtitle{color:var(--muted); font-size:13px}
    .hero{margin:32px 0 18px; display:flex; align-items:flex-end; justify-content:space-between; gap:16px}
    .pill{display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:999px; background:linear-gradient(180deg,rgba(255,255,255,0.08),rgba(255,255,255,0.02)); border:1px solid rgba(255,255,255,0.12)}
    .pill .dot{width:8px; height:8px; border-radius:999px; background:var(--good); box-shadow:0 0 12px var(--good)}
    .card{background:var(--glass); border:1px solid rgba(255,255,255,0.12); border-radius:var(--card-radius); box-shadow:var(--shadow); backdrop-filter:blur(var(--blur)) saturate(140%); position:relative}
    .card:hover{border-color:rgba(255,255,255,0.18)}
    .tools{display:grid; grid-template-columns:1fr 1fr; gap:16px; margin:14px 0 28px}
    .tool{padding:14px}
    .tool h4{margin:0 0 8px}
    .tool .row{display:flex; gap:10px; margin-bottom:8px}
    .tool input,.tool select{width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,0.12); background:rgba(255,255,255,0.06); color:var(--text)}
    .tool button{padding:10px 14px; border-radius:12px; border:0; background:linear-gradient(180deg,#85a9ff,#6f8df1); color:#081021; font-weight:600; cursor:pointer}
    .tool button:hover{filter:brightness(1.05)}
    .list{display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); gap:16px}
    .offer{padding:14px; overflow:hidden}
    .offer .top{display:flex; justify-content:space-between; align-items:flex-start}
    .badge{padding:6px 10px; border-radius:999px; font-size:12px; color:#081021; background:linear-gradient(180deg,#a7f3d0,#34d399); font-weight:700}
    .risk{padding:6px 10px; border-radius:999px; font-size:12px; color:#081021; background:linear-gradient(180deg,#fde68a,#fbbf24); font-weight:700}
    .apr{font-size:28px; font-weight:800; letter-spacing:0.2px}
    .muted{color:var(--muted); font-size:13px}
    .money{font-size:20px; font-weight:700}
    .row{display:flex; gap:10px; align-items:center}
    .actions{display:flex; gap:8px; margin-top:10px}
    .btn{padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,0.12); background:rgba(255,255,255,0.06); color:var(--text); cursor:pointer}
    .btn.primary{background:linear-gradient(180deg,#85a9ff,#6f8df1); color:#081021; border:0; font-weight:700}
    .btn.glow{box-shadow:0 0 0 rgba(122,169,255,0); animation:glow 2.4s ease-in-out infinite}
    @keyframes glow{0%,100%{box-shadow:0 0 0 rgba(122,169,255,0)}50%{box-shadow:0 0 28px rgba(122,169,255,0.35)}}
    .fav{cursor:pointer; width:28px; height:28px; display:grid; place-items:center; border-radius:999px; background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.12)}
    .fav.active{background:linear-gradient(180deg,#fb7185,#ef4444); color:#081021; font-weight:900}
    footer{grid-column:2; margin:30px 0 40px; color:var(--muted); font-size:12px}
    /* Modal */
    .modal-backdrop{position:fixed; inset:0; background:rgba(6,7,10,0.6); backdrop-filter:blur(6px); display:none; align-items:center; justify-content:center; z-index:50}
    .modal{width:min(680px,92vw); padding:18px; border-radius:20px; background:var(--glass-strong); border:1px solid rgba(255,255,255,0.16); box-shadow:0 20px 60px rgba(0,0,0,0.55)}
    .modal h3{margin:0 0 10px}
    .split{display:grid; grid-template-columns:1.2fr 1fr; gap:14px}
    .kv{display:grid; grid-template-columns:1fr 1fr; gap:8px; margin:8px 0}
    .kv div{background:rgba(255,255,255,0.06); padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,0.12)}
    .close{float:right; cursor:pointer; opacity:0.7}
    .close:hover{opacity:1}
    .disclaimer{font-size:12px; color:var(--muted); border-top:1px dashed rgba(255,255,255,0.14); padding-top:8px; margin-top:8px}
  </style>
</head>
<body>
  <header class="grid">
    <div class="wrap">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <div class="title">LendX — люди людям</div>
          <div class="subtitle">Маркетплейс займов: каждый может дать или взять деньги на честных условиях</div>
        </div>
      </div>
      <div class="hero">
        <div class="pill"><span class="dot"></span><span>Beta-концепт • локальные данные • без банков</span></div>
        <div class="pill"><span>Надёжность ≈ рейтинг + история возвратов</span></div>
      </div>
      <div class="tools">
        <div class="card tool">
          <h4>Фильтры</h4>
          <div class="row">
            <input id="fAmount" type="number" placeholder="Мин. сумма, ₽" />
            <select id="fTerm">
              <option value="">Срок</option>
              <option value="7">≤ 7 дней</option>
              <option value="30">≤ 30 дней</option>
              <option value="90">≤ 90 дней</option>
            </select>
            <input id="fApr" type="number" placeholder="Макс. APR, %" />
          </div>
          <div class="row">
            <select id="sort">
              <option value="best">Выгодность</option>
              <option value="rating">Надёжность</option>
              <option value="amount">Сумма</option>
              <option value="new">Новизна</option>
            </select>
            <button id="apply">Применить</button>
            <button id="reset" style="background:rgba(255,255,255,0.06); color:var(--text)">Сброс</button>
          </div>
        </div>
        <div class="card tool">
          <h4>Стать кредитором</h4>
          <div class="row">
            <input id="cAmount" type="number" placeholder="Сумма, ₽" />
            <input id="cTerm" type="number" placeholder="Срок, дней" />
            <input id="cApr" type="number" placeholder="Ставка APR, %" />
          </div>
          <div class="row">
            <input id="cNote" type="text" placeholder="Комментарий (например, вернёте +20%)" />
            <button id="create">Опубликовать</button>
          </div>
          <div class="muted">Совет: APR — годовая ставка. Итог рассчитываем пропорционально сроку.</div>
        </div>
      </div>
    </div>
  </header>

  <main class="grid">
    <div class="wrap">
      <section class="list" id="list"></section>
    </div>
  </main>

  <div class="modal-backdrop" id="backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal">
      <span class="close" id="close">✕</span>
      <h3 id="mTitle">Предложение займа</h3>
      <div class="split">
        <div>
          <div class="kv">
            <div><b>Сумма:</b> <span id="mAmount"></span> ₽</div>
            <div><b>Срок:</b> <span id="mTerm"></span> дней</div>
            <div><b>APR:</b> <span id="mApr"></span>%</div>
            <div><b>Рейтинг:</b> <span id="mRating"></span>/5</div>
          </div>
          <div class="kv">
            <div><b>Итого к возврату:</b> <span id="mTotal"></span> ₽</div>
            <div><b>На каждый день:</b> <span id="mPerDay"></span> ₽</div>
          </div>
          <div class="muted" id="mNote"></div>
          <div class="disclaimer">
            Концепт: здесь нет реальных договоров, KYC, страховки и арбитража. Это демо UX. Не используйте для реальных займов.
          </div>
        </div>
        <div>
          <div class="row" style="margin-bottom:8px">
            <button class="btn primary glow" id="request">Запросить займ</button>
            <button class="btn" id="favorite">В избранное</button>
          </div>
          <div class="muted" id="mStatus"></div>
        </div>
      </div>
    </div>
  </div>

  <footer class="wrap">
    Сделано как концепт для шоукейса UX/финтех. Данные — в браузере. Анимации и стекло — для эффекта «premium boutique».
  </footer>

  <script>
    const $ = sel => document.querySelector(sel);
    const now = () => Date.now();

    const mock = [
      {id:1, amount:5000, term:30, apr:240, rating:4.7, note:"Вернёте 6 000 за месяц. Без досрочного штрафа.", created:now()-86400000*2},
      {id:2, amount:12000, term:14, apr:150, rating:4.9, note:"Ставка лояльная. Частичный досрочный ок.", created:now()-86400000*4},
      {id:3, amount:3000, term:7, apr:320, rating:4.2, note:"Короткий займ. Возврат строго в срок.", created:now()-86400000*1},
      {id:4, amount:25000, term:60, apr:90, rating:5.0, note:"Надёжный кредитор 100% возвратов.", created:now()-86400000*6},
      {id:5, amount:9000, term:21, apr:180, rating:4.5, note:"Гибкий график, можно частями.", created:now()-86400000*3}
    ];

    const storeKey = "lendx_offers";
    const favKey = "lendx_favs";

    const loadOffers = () => {
      const saved = localStorage.getItem(storeKey);
      return saved ? JSON.parse(saved) : mock.slice();
    };
    const saveOffers = (offers) => localStorage.setItem(storeKey, JSON.stringify(offers));
    const loadFavs = () => {
      const f = localStorage.getItem(favKey);
      return f ? JSON.parse(f) : [];
    };
    const saveFavs = (favs) => localStorage.setItem(favKey, JSON.stringify(favs));

    let offers = loadOffers();
    let favs = loadFavs();
    let current = null;

    function aprToTotal(amount, termDays, apr){
      const perYear = apr/100;
      const fractionOfYear = termDays/365;
      const interest = amount * perYear * fractionOfYear;
      return Math.round(amount + interest);
    }

    function render(){
      const list = $("#list");
      list.innerHTML = "";
      const fAmount = Number($("#fAmount").value) || 0;
      const fTerm = Number($("#fTerm").value) || Infinity;
      const fApr = $("#fApr").value ? Number($("#fApr").value) : Infinity;
      const sortBy = $("#sort").value;

      let rows = offers.filter(o =>
        o.amount >= fAmount &&
        o.term <= (isFinite(fTerm) ? fTerm : o.term) &&
        o.apr <= (isFinite(fApr) ? fApr : o.apr)
      );

      rows.sort((a,b) => {
        if(sortBy === "best"){
          const gainA = (aprToTotal(a.amount,a.term,a.apr)-a.amount)/a.amount;
          const gainB = (aprToTotal(b.amount,b.term,b.apr)-b.amount)/b.amount;
          return gainA - gainB; // меньше выгода для заёмщика — лучше
        }
        if(sortBy === "rating") return b.rating - a.rating;
        if(sortBy === "amount") return b.amount - a.amount;
        if(sortBy === "new") return b.created - a.created;
        return 0;
      });

      rows.forEach(o => {
        const card = document.createElement("div");
        card.className = "card offer";
        const isFav = favs.includes(o.id);
        const total = aprToTotal(o.amount,o.term,o.apr);
        const riskClass = o.apr > 250 ? "risk" : "badge";
        const trustLabel = o.rating >= 4.8 ? "Надёжный" : (o.rating >= 4.3 ? "Хороший" : "Норм");
        card.innerHTML = `
          <div class="top">
            <div>
              <div class="row" style="gap:8px; align-items:center">
                <div class="${riskClass}">${o.apr}% APR</div>
                <div class="badge">${trustLabel}</div>
              </div>
              <div class="apr">${o.amount.toLocaleString("ru-RU")} ₽</div>
              <div class="muted">Срок: ${o.term} дн · Рейтинг: ${o.rating.toFixed(1)} / 5</div>
            </div>
            <div class="fav ${isFav ? "active":""}" data-id="${o.id}" title="В избранное">★</div>
          </div>
          <div class="row" style="margin-top:8px">
            <div class="money">Итого: ${total.toLocaleString("ru-RU")} ₽</div>
            <div class="muted">(${Math.round(total/o.term).toLocaleString("ru-RU")} ₽/день)</div>
          </div>
          <div class="muted" style="margin-top:8px">${o.note || ""}</div>
          <div class="actions">
            <button class="btn primary" data-id="${o.id}" data-action="open">Детали</button>
            <button class="btn" data-id="${o.id}" data-action="request">Запросить</button>
          </div>
        `;
        list.appendChild(card);
      });
    }

    function openModal(offer){
      current = offer;
      $("#mTitle").textContent = `Предложение #${offer.id}`;
      $("#mAmount").textContent = offer.amount.toLocaleString("ru-RU");
      $("#mTerm").textContent = offer.term;
      $("#mApr").textContent = offer.apr;
      $("#mRating").textContent = offer.rating.toFixed(1);
      const total = aprToTotal(offer.amount, offer.term, offer.apr);
      $("#mTotal").textContent = total.toLocaleString("ru-RU");
      $("#mPerDay").textContent = Math.round(total/offer.term).toLocaleString("ru-RU");
      $("#mNote").textContent = offer.note || "—";
      $("#mStatus").textContent = "Статус: свободно • ожидает запросов";
      $("#backdrop").style.display = "flex";
      $("#backdrop").setAttribute("aria-hidden", "false");
    }

    function closeModal(){
      $("#backdrop").style.display = "none";
      $("#backdrop").setAttribute("aria-hidden", "true");
      current = null;
    }

    // Events
    $("#apply").addEventListener("click", render);
    $("#reset").addEventListener("click", () => {
      $("#fAmount").value = "";
      $("#fTerm").value = "";
      $("#fApr").value = "";
      $("#sort").value = "best";
      render();
    });

    $("#create").addEventListener("click", () => {
      const amount = Number($("#cAmount").value);
      const term = Number($("#cTerm").value);
      const apr = Number($("#cApr").value);
      const note = $("#cNote").value.trim();

      // Простые проверки
      const errs = [];
      if(!amount || amount < 500) errs.push("Сумма от 500 ₽");
      if(!term || term < 3) errs.push("Срок от 3 дней");
      if(!apr || apr < 10 || apr > 400) errs.push("APR 10–400%");
      if(errs.length){
        alert("Проверь поля:\n• " + errs.join("\n• "));
        return;
      }

      const newOffer = {
        id: Math.max(...offers.map(o=>o.id)) + 1,
        amount, term, apr, rating: 4.5, note,
        created: now()
      };
      offers.unshift(newOffer);
      saveOffers(offers);
      $("#cAmount").value = "";
      $("#cTerm").value = "";
      $("#cApr").value = "";
      $("#cNote").value = "";
      render();
      // микро-эффект
      const el = document.querySelector(".offer");
      el && el.animate([{transform:"scale(0.98)"},{transform:"scale(1)"}],{duration:300, easing:"ease-out"});
    });

    document.body.addEventListener("click", (e) => {
      const t = e.target;
      if(t.id === "close") closeModal();
      if(t.id === "backdrop" && e.target === $("#backdrop")) closeModal();

      if(t.classList.contains("fav")){
        const id = Number(t.dataset.id);
        const idx = favs.indexOf(id);
        if(idx >= 0) favs.splice(idx,1); else favs.push(id);
        saveFavs(favs);
        t.classList.toggle("active");
      }

      if(t.dataset && t.dataset.action === "open"){
        const id = Number(t.dataset.id);
        const offer = offers.find(o=>o.id===id);
        openModal(offer);
      }

      if(t.dataset && t.dataset.action === "request"){
        const id = Number(t.dataset.id);
        const offer = offers.find(o=>o.id===id);
        openModal(offer);
        $("#mStatus").textContent = "Заявка отправлена (демо). Кредитор увидит запрос и свяжется.";
      }

      if(t.id === "request"){
        if(!current) return;
        $("#mStatus").textContent = "Запрос подтверждён (демо). Ожидайте ответ.";
      }

      if(t.id === "favorite" && current){
        const id = current.id;
        const idx = favs.indexOf(id);
        if(idx >= 0) favs.splice(idx,1); else favs.push(id);
        saveFavs(favs);
        $("#mStatus").textContent = favs.includes(id) ? "Добавлено в избранное." : "Удалено из избранного.";
      }
    });

    // Initial
    render();
  </script>
</body>
</html>
